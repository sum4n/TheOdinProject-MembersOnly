<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home Page</title>
  </head>
  <body>
    <% if (user) {%>
    <h1>Welcome back <%= user.username %></h1>
    <p>
      <a href="/message/<%= user.id %>/create-new-message"
        >Create a new message</a
      >
    </p>
    <small><a href="/user/log-out">Log out</a></small>

    <% } else { %>
    <h1>Welcome visitor</h1>
    <h2>Please log in</h2>
    <form action="/user/log-in" method="POST">
      <label for="username">Username: </label>
      <input type="username" name="username" placeholder="username" required />
      <label for="password">Password: </label>
      <input
        type="password"
        name="password"
        placeholder="Type in your password"
        required
      />
      <button type="submit">Log In</button>
    </form>
    <p>
      <small>New user: <a href="/user/sign-up">Sign up</a></small>
    </p>
    <% } %>

    <!--  Display messages. -->
    <h2>Messages:</h2>
    <% if (typeof message_list !== 'undefined') { %>
    <ul style="list-style-type: none; padding: 0; margin: 0">
      <hr />
      <% message_list.forEach(function(message) { %>
      <li>
        <p style="font-size: 1.5rem; text-decoration: underline">
          <%= message.title %>
        </p>
        <p style="font-size: 1rem"><%= message.text %></p>
        <% if (user?.membership_status) { %>
        <p>
          <small style="font-weight: bold"><%= message.author.name %> - </small>
          <small>(<%= message.timestamp_formatted %>)</small>
        </p>
        <% } %>
        <hr />
      </li>
      <% }) %>
    </ul>
    <% } %>
  </body>
</html>
